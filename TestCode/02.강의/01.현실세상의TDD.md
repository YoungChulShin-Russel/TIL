# 테스트 주도 개발 기초
## 코드 기능 명세
도메인
- 소프트웨어가 풀어야할 문제가 정의되는 공간
- 문제를 잘 이애하지 못하면 문제를 푸는 도구(소프트웨어)를 잘 만들 수 없다. 그래서 도메인을 잘 이해해야한다. 
- 프로그래머가 충분히 명확한 도메인 지식을 확보하지 못했다면 지힉 흐름 상류(비지니스 전문가, 분석가)에게 요청해야한다. 스스로 결정을 내리면 지식에 오차가 발생하거나 도박 행위일 수 있다. 

## 테스트 기법
수동 테스트
- 품질 담당자가 UI를 사용해 기능을 검증
- 실행 비용이 높고 가장 온전한 코드 실행
- 기능이 b -> c로 개발되었는데, 영향이 a -> b도 받을 수 있지만, 테스트는 이 부분을 제한적으로 하거나 스킵한다. 

테스트 자동화
- 기능을 담당하는 코드를 작성
- 실행 비용이 낮고 결과의 신뢰도가 높다
- 테스트 코드 작성/관리가 프로그래머의 역량에 크게 영향을 받는다

인수테스트
- 배치된 시스템을 대상으로 검증
- 쩐체 시스템 이상 여부 신뢰도가 높으나 비용도 높고, 피드백 품질이 낮다. (현상은 드러나지만 원인은 숨겨짐)

단위 테스트
- 시스템의 일부를 대상으로 검증
- 비용이 낮고 피드백 품질이 높으나 전체 시스템 이상 여부 신뢰도가 낮다

## 코드 분해
모듈
- 인터페이스와 구현으로 분리
- 재사용 될 때에는 인터페이스를 보면서 재사용한다

## 단위 테스트
반복되는 테스트라면 for문이나 반복테스트로 반복을 줄이자. 대신 어떤 값이 실패했는지 알아야한다. > ParameterizedTest

## 테스트 우선 개발
운용코드보다 테스트코드를 먼저 작성
- 명확하고 검증 가능한 목표를 설정한 후에 목표를 달성
- 코드를 작성하기에 앞서 어떤 방법으로 풀어야하는지를 확실히 이해해야한다

## 정리된 코드
리팩터링
- 의미를 유지하며 코드 베이스르르 정리하는 것. 의미가 변하지 않는게 중요하다.
- 예: x^2-4를 (x-2)(x+2)로 분리

테스트가 잘 작성되어 있으면 의미가 변하지 않는지 확인하면서 리팩터링을 할 수 있다. 

리팩터링 작업 내용
- 기능을 작은 함수로 분리
- 3항 연산자 사용
- 라이브러리에서 제공해주는 기능이 있으면 사용
- 복수 연산은 메서드명을 복수로 하고, 내부적으로 반복되는 수행 코드를 다시 단수의 의미를 가지는 메서드로 분리
- 가능하면 반복 작업이 없도록

## 테스트 주도 개발
개발 절차
- RED: 실패하는 테스트 추가
   - 테스트가 성공하면 단위 테스트를 다시 작성한다
- GREEN: 테스트 통과. 최소한의 코딩
   - 테스트를 통과할 수 있는 가장 빠르고 간단하게 수정한다
- REFACTOR: 구현 설계 개선. 테스트 통과 유지

켄트벡의 설계 규칙
- Passes the tests
- Reveals intention
- No duplication
- Fewest elements (앞에 설명한 3가지의 기능을 제외한 코드는 최소화)

TDD의 비용 (기능 1개를 개발하는)
- TDD를 사용하지 않으면 시간이 지날 수록 비용이 증가한다
- TDD를 사용하면 초기 비용은 TDD를 사용하지 않을 때 보다 높지만, 시간이 지나도 비용이 일정하게 유지된다
- 시간 정보
   - t1: tdd 사용이 tdd 사용을 하지 않을 때 보다 비용이 더 싸지는 시점
   - t2: tdd 사용이 tdd 사용을 하지 않을 때 보다 시간 총 합의 비용이 더 싸지는 시점
- tdd 사용여부는 프로젝트의 수명이 t2보다 클 경우에 도입을 해야한다
- 프로그래머의 역량이나 도구의 지원을 통해서 t2를 줄일 수 있다

## 프로그래머 피드백
프로그래머는 가끔 요구사항 외에 성능 달성이나 구현 설계 개선 같은 개발자의 만족도를 높일 수 있는 부분에 빠져드는 경향이 있다. 이 자체가 나쁜것은 아니나 제일 중요한 것은 목표 달성이이 때문에 여기에 가장 집중을 해야한다. 

TDD의 핵심은 정해진 절차가 아니라 짧은 주기로 지속되는 피드백이다. 