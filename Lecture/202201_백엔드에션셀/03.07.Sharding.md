# 대규모 서비스 설계를 위한 백엔드 에센셜
## Sharding
개념
- 데이터를 분산해서 저장하는 방식
- 데이터를 어떤 방법으로 분산해서 저장할지가 중요하다

방법 1. Range
- 특정 범위 대역을 나누는 방식. 예: 1000명당 1개의 서버
- 새롭게 추가하는게 쉽다
- shard 간 데이터가 균등하지 못할 수 있다

방법 2. Modular
- 서버 대수로 나누어서 저장하는 방식. 예: 서버 대수가 4대라면 0 -> 0, 1 -> 1, 4 -> 0
- 인스턴스가 추가되면 데이터 이동이 심해진다
- 인스턴스를 2배로 추가하는 방법을 이용하면 이동이 명확해지는데, 대신 서버 대수가 어느정도 증가하면 문제가 된다. 
   - 예: 8대 다음은 16대, 다음은 32대가 되기 때문ㄴ
   - 일정 규모 이상에서는 scale-up을 한다

방법 3. Indexed
- 특정 데이터의 위치를 가리키는 index 서버가 존재
- index를 조작해서 데이터를 이동할 수 있기 때문에 데이터 분배가 쉽다
- index 서버를 관리해야 하기 때문에 관리 포인트가 증가하고, index 서버가 SPOF가 될 수 있다
   - client에서 cache해서 index 서버에 한번만 질의하는 방법도 있다

방법 4. Complexed
- index 서버가 존재하고, index 서버는 range는 관리한다
- 각 서버는 primary, secondary가 존재하는 query off 또는 active standby 방식을 사용한다
- 구현이 복잡하다

기타
- shard 관리를 zookeeper로 할 수 있다