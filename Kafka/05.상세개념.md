# 상세개념
## 토픽, 파티션
### 적정 파션 개수
데이터 처리량을 올리는 방법
1. 컨슈머의 처리량을 올리는 방법
2. 컨슈머를 추가해서 병렬처리량을 늘리는 방법

이론적으로는 `'프로듀서 전송량 < 컨슈며 처리량 * 파티션 개수'` 이면된다
- 컨슈머의 처리량은 상용에서 더미데이터를 이용해서 확인힌다. 로컬과 상용의 환경차이가 있을 수 있기 때문에 상용에서 테스트를 해본다. 

메시지키를 사용하는데, 중간에 파티션이 변경되면 메시지 키의 순서를 보장받지 못할 수 있다
- 파티션 개수가 달라지는 순간에는 변환하기 전/후로해서 메시지키의 파티션 위치가 달라지기 때문이다

메시지키를 사용하고 컨슈머에서 처리순서가 보장되어야한다면 파티션의 변화가 발생하지 않는 방향으로 가야한다
- 파티션의 개수를 처음부터 넉넉하게 잡고 생성하는 방법이 있다
- 만약에 순서가 중요하지 않다면, 처음부터 파티션의 수를 넉넉하게 잡지 않아도 된다

브로커당 파티션 개수를 모니터링해야한다
- 파티션이 늘어나면 브로커가 접근해야하는 파일수가 많아진다. OS에서는 프로세스당 열 수 있는 파일 최대개수를 제한하고 있기 때문에 모니터링이 필요하다
- 브로커가 관리하는 파티션의 수가 너무 많다면 파티션 수를 분산하기 위해서 브로커수를 늘리는것도 하나의 방법이다